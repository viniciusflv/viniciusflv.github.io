---
import Header from '../components/Header.astro';
import SEO from './SEO.astro';

import { getLanguageFromURL } from '../util';

// import ogScraper from 'open-graph-scraper';
// ogScraper({
//   url: 'https://twitter.com/viniciusflv1/',
// })
//   .then(({ result }) => console.log(result))
//   .catch(console.error);

const lang = getLanguageFromURL(Astro.url.pathname);
const knownLanguages = ['en', 'pt-BR'];
const formatAlternateHref = (hreflang: string) =>
  new URL(
    Astro.url.pathname.replace(/^\/(.*)\//g, `/${hreflang}/`),
    Astro.site,
  );
---

<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover"
      name="viewport"
    />
    <!-- lang -->
    <meta content={lang} property="og:locale" />
    {
      knownLanguages.map((hreflang) => (
        <link
          rel="alternate"
          href={formatAlternateHref(hreflang)}
          hreflang={hreflang}
        />
      ))
    }
    <SEO {...Astro.props} />
  </head>

  <body class="body">
    <section class:list={['section']}>
      <Header lang={lang} knownLanguages={knownLanguages} />
      <slot />
    </section>
    <style is:global>
      * {
        /* outline: 0.01px solid red; */
        @media (prefers-reduce-motion: reduce) {
          animation-duration: 0ms !important;
          scroll-behavior: initial;
        }

        scroll-behavior: smooth;

        @media (orientation: landscape) {
          ::-webkit-scrollbar {
            @apply dark:w-3;
          }
          ::-webkit-scrollbar-track {
            @apply dark:bg-black;
          }
          ::-webkit-scrollbar-thumb {
            @apply rounded-full dark:bg-dark-green;
          }
        }
      }

      .body {
        @apply font-paragraph text-gray-800 dark:text-gray-100;

        @apply flex w-full
        min-h-screen
        bg-white
        dark:bg-dark-darkest;

        .section {
          @apply flex
          flex-col
          w-full;

          h1 {
            @apply text-3xl
            lg:text-5xl
            font-bold
            tracking-wider;

            @apply bg-gradient-to-r to-black;
          }

          h2 {
            @apply lg:text-2xl opacity-80;
          }

          h3 {
            @apply lg:text-2xl font-bold;
          }

          strong {
            @apply text-black dark:text-dark-green;
          }

          p {
            @apply text-gray-600 dark:text-gray-300;
          }

          article {
            a {
              @apply underline
              text-blue-400
              dark:text-dark-cyan;
            }

            blockquote {
              @apply italic
              p-4
              border-l-4
              border-l-dark-green
              bg-black
              bg-opacity-10;
            }
          }

          hr {
            @apply border-dark-comment;
          }

          .shiki.dracula {
            @apply rounded
            shadow-2xl
            border
            border-gray-200
            dark:border-dark-currentLine;

            .language-id {
              @apply p-2
              px-8
              rounded-t
              bg-opacity-50
              text-dark-green;

              @apply border-b
              border-dark-green;
            }

            .code-container {
              @apply p-8
              overflow-auto;

              &::-webkit-scrollbar {
                @apply w-3;
              }
              &::-webkit-scrollbar-track {
                @apply bg-black;
              }
              &::-webkit-scrollbar-thumb {
                @apply rounded-full bg-dark-green;
              }
            }

            @media (prefers-color-scheme: light) {
              @apply !bg-white;

              & .language-id,
              .code-container {
                @apply invert;
              }
            }
          }
        }
      }
    </style>
  </body>
</html>
