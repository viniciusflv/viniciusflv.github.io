---
import SEO from '@/layouts/SEO.astro';
import { getLanguageFromURL } from '@/util';

import Header from '../components/Header.astro';

const lang = getLanguageFromURL(Astro.url.pathname);
const knownLanguages = ['en', 'pt-BR'];
const formatAlternateHref = (hreflang: string) =>
  new URL(
    Astro.url.pathname.replace(/^\/(.*)\//g, `/${hreflang}/`),
    Astro.site,
  );
console.log({ lang });
---

<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta content={lang} property="og:locale" />
    {
      knownLanguages.map((hreflang) => (
        <link
          rel="alternate"
          href={formatAlternateHref(hreflang)}
          hreflang={hreflang}
        />
      ))
    }
    <SEO lang={lang} {...Astro.props} />
  </head>
  <body class="enabled">
    <section class="page">
      <Header lang={lang} knownLanguages={knownLanguages} {...Astro.props} />
      <slot />
    </section>
    <style is:global>
      .dark .enabled {
        color-scheme: dark;
      }
      html,
      body {
        &.enabled {
          @apply dark:bg-dark-darkest;
          width: 100%;
          height: 100vh;
          display: flex;

          .page {
            @apply grid
            w-full
            h-full;
          }
        }
      }

      * {
        @apply scroll-smooth
        transition-colors
        duration-75;
      }

      @media (orientation: landscape) {
        ::-webkit-scrollbar {
          @apply w-3;
        }
        ::-webkit-scrollbar-track {
          @apply bg-dark-foreground dark:bg-[color:#0005] rounded-full;
        }
        ::-webkit-scrollbar-thumb {
          @apply rounded-full bg-dark-comment dark:bg-dark-green;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          animation-duration: 0ms !important;
          transition-duration: 0ms !important;
          scroll-behavior: initial;
        }
      }
    </style>
  </body>
</html>
